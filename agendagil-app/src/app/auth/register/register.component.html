<div
  class="d-flex flex-column justify-content-between min-vh-100"
  style="background-color: #1b4f72"
>
  <div class="d-flex justify-content-center align-items-center flex-grow-1">
    <div
      class="card p-4 shadow"
      style="width: 100%; max-width: 400px; border-radius: 10px"
    >
      <!-- Logo -->
      <div class="text-center mb-3">
        <img src="../../../assets/logo.jpg" alt="AgendAgil Logo" width="200" />
      </div>

      <!-- Formulário de Registro -->
      <form [formGroup]="registerForm" (ngSubmit)="onSubmit()">
        <!-- Tipo de Usuário -->
        <div>
          <label for="tipo" class="form-label text-white"
            >Tipo de Usuário</label
          >
          <select
            id="tipo"
            class="form-select"
            formControlName="tipo"
            [ngClass]="{
              'is-invalid':
                registerForm.get('tipo')?.invalid &&
                registerForm.get('tipo')?.touched
            }"
          >
            <option value="" disabled>Selecione o perfil</option>
            <option *ngFor="let tipo of tipos" [value]="tipo.value">
              {{ tipo.label }}
            </option>
          </select>
          <div
            *ngIf="
              registerForm.get('tipo')?.invalid &&
              registerForm.get('tipo')?.touched
            "
            class="invalid-feedback"
          >
            Tipo de usuário é obrigatório.
          </div>
        </div>

        <!-- Nome Completo -->
        <div>
          <label for="nome" class="form-label text-white">Nome completo</label>
          <input
            type="text"
            id="nome"
            class="form-control"
            placeholder="Digite seu nome completo"
            formControlName="nome"
            [ngClass]="{
              'is-invalid':
                registerForm.get('nome')?.invalid &&
                registerForm.get('nome')?.touched
            }"
          />
          <div
            *ngIf="
              registerForm.get('nome')?.invalid &&
              registerForm.get('nome')?.touched
            "
            class="invalid-feedback"
          >
            Nome é obrigatório.
          </div>
        </div>

        <!-- Email -->
        <div>
          <label for="email" class="form-label text-white">Email</label>
          <input
            type="email"
            id="email"
            class="form-control"
            placeholder="Digite seu email"
            formControlName="email"
            [ngClass]="{
              'is-invalid':
                registerForm.get('email')?.invalid &&
                registerForm.get('email')?.touched
            }"
          />
          <div
            *ngIf="
              registerForm.get('email')?.invalid &&
              registerForm.get('email')?.touched
            "
            class="invalid-feedback"
          >
            <div *ngIf="registerForm.get('email')?.errors?.required">
              Email é obrigatório.
            </div>
            <div *ngIf="registerForm.get('email')?.errors?.email">
              Digite um email válido.
            </div>
          </div>
        </div>

        <!-- Senha -->
        <div>
          <label for="senha" class="form-label text-white">Senha</label>
          <input
            type="password"
            id="senha"
            class="form-control"
            placeholder="Digite sua senha"
            formControlName="senha"
            [ngClass]="{
              'is-invalid':
                registerForm.get('senha')?.invalid &&
                registerForm.get('senha')?.touched
            }"
          />
          <div
            *ngIf="
              registerForm.get('senha')?.invalid &&
              registerForm.get('senha')?.touched
            "
            class="invalid-feedback"
          >
            Senha é obrigatória.
          </div>
        </div>

        <!-- Campos adicionais baseados no tipo de usuário -->
        <!-- PACIENTE -->
        <div *ngIf="tipoUsuarioSelecionado === tipoUsuarioEnum.PACIENTE">
          <div>
            <label for="cpf" class="form-label text-white">CPF</label>
            <input
              type="text"
              id="cpf"
              class="form-control"
              placeholder="Digite seu CPF"
              formControlName="cpf"
              mask="000.000.000-00"
              [ngClass]="{
                'is-invalid':
                  registerForm.get('cpf')?.invalid &&
                  registerForm.get('cpf')?.touched
              }"
            />
            <div
              *ngIf="
                registerForm.get('cpf')?.invalid &&
                registerForm.get('cpf')?.touched
              "
              class="invalid-feedback"
            >
              CPF é obrigatório.
            </div>
          </div>

         <!-- <div>
            <label for="dataNascimento" class="form-label text-white"
              >Data de Nascimento</label
            >
            <input
              type="date"
              id="dataNascimento"
              class="form-control"
              formControlName="dataNascimento"
              max="{{ hoje }}"
              [ngClass]="{
                'is-invalid':
                  registerForm.get('dataNascimento')?.invalid &&
                  registerForm.get('dataNascimento')?.touched
              }"
            />
            <div
              *ngIf="
                registerForm.get('dataNascimento')?.invalid &&
                registerForm.get('dataNascimento')?.touched
              "
              class="invalid-feedback"
            >
              Data de nascimento é obrigatória e deve ser válida.
            </div>
          </div>-->

          <div class="mb-4">
            <label for="genero" class="form-label text-white">Gênero</label>
            <select id="genero" class="form-select" formControlName="genero">
              <option value="">Gênero</option>
              <option value="Masculino">Masculino</option>
              <option value="Feminino">Feminino</option>
              <option value="Outro">Outro</option>
              <option value="Prefiro não dizer">Prefiro não dizer</option>
            </select>
          </div>
        </div>

        <!-- PROFISSIONAL AUTÔNOMO -->
        <div
          *ngIf="
            tipoUsuarioSelecionado === tipoUsuarioEnum.PROFISSIONAL_AUTONOMO
          "
        >
          <div>
            <label for="cpf" class="form-label text-white">CPF</label>
            <input
              type="text"
              id="cpf"
              class="form-control"
              placeholder="Digite seu CPF"
              formControlName="cpf"
              mask="000.000.000-00"
              [ngClass]="{
                'is-invalid':
                  registerForm.get('cpf')?.invalid &&
                  registerForm.get('cpf')?.touched
              }"
            />
            <div
              *ngIf="
                registerForm.get('cpf')?.invalid &&
                registerForm.get('cpf')?.touched
              "
              class="invalid-feedback"
            >
              CPF é obrigatório.
            </div>
          </div>

          <div>
            <label for="crm" class="form-label text-white">CRM</label>
            <input
              type="text"
              id="crm"
              class="form-control"
              placeholder="Digite seu CRM"
              formControlName="crm"
              [ngClass]="{
                'is-invalid':
                  registerForm.get('crm')?.invalid &&
                  registerForm.get('crm')?.touched
              }"
            />
            <div
              *ngIf="
                registerForm.get('crm')?.invalid &&
                registerForm.get('crm')?.touched
              "
              class="invalid-feedback"
            >
              CRM é obrigatório.
            </div>
          </div>

          <div>
            <label for="especialidade" class="form-label text-white"
              >Especialidade</label
            >
            <input
              type="text"
              id="especialidade"
              class="form-control"
              placeholder="Digite sua especialidade"
              formControlName="especialidade"
              [ngClass]="{
                'is-invalid':
                  registerForm.get('especialidade')?.invalid &&
                  registerForm.get('especialidade')?.touched
              }"
            />
            <div
              *ngIf="
                registerForm.get('especialidade')?.invalid &&
                registerForm.get('especialidade')?.touched
              "
              class="invalid-feedback"
            >
              Especialidade é obrigatória.
            </div>
          </div>

          <div>
            <label for="formacao" class="form-label text-white">Formação</label>
            <input
              type="text"
              id="formacao"
              class="form-control"
              placeholder="Digite sua formação"
              formControlName="formacao"
            />
          </div>

          <div>
            <label for="experiencia" class="form-label text-white"
              >Experiência</label
            >
            <textarea
              id="experiencia"
              class="form-control"
              placeholder="Descreva sua experiência"
              formControlName="experiencia"
              rows="3"
            ></textarea>
          </div>

          <div>
            <label for="descricao" class="form-label text-white"
              >Descrição</label
            >
            <textarea
              id="descricao"
              class="form-control"
              placeholder="Descrição profissional"
              formControlName="descricao"
              rows="2"
            ></textarea>
          </div>

          <div class="mb-3">
            <label for="siteProfissional" class="form-label text-white"
              >Site Profissional</label
            >
            <input
              type="url"
              id="siteProfissional"
              class="form-control"
              placeholder="URL do seu site profissional"
              formControlName="siteProfissional"
            />
          </div>
        </div>

        <!-- CLÍNICA -->
        <div *ngIf="tipoUsuarioSelecionado === tipoUsuarioEnum.CLINICA">
          <div>
            <label for="cnpj" class="form-label text-white">CNPJ</label>
            <input
              type="text"
              id="cnpj"
              class="form-control"
              placeholder="Digite o CNPJ da clínica"
              formControlName="cnpj"
              mask="00.000.000/0000-00"
              [ngClass]="{
                'is-invalid':
                  registerForm.get('cnpj')?.invalid &&
                  registerForm.get('cnpj')?.touched
              }"
            />
            <div
              *ngIf="
                registerForm.get('cnpj')?.invalid &&
                registerForm.get('cnpj')?.touched
              "
              class="invalid-feedback"
            >
              CNPJ é obrigatório.
            </div>
          </div>

          <div>
            <label for="razaoSocial" class="form-label text-white"
              >Razão Social</label
            >
            <input
              type="text"
              id="razaoSocial"
              class="form-control"
              placeholder="Digite a razão social"
              formControlName="razaoSocial"
              [ngClass]="{
                'is-invalid':
                  registerForm.get('razaoSocial')?.invalid &&
                  registerForm.get('razaoSocial')?.touched
              }"
            />
            <div
              *ngIf="
                registerForm.get('razaoSocial')?.invalid &&
                registerForm.get('razaoSocial')?.touched
              "
              class="invalid-feedback"
            >
              Razão social é obrigatória.
            </div>
          </div>

          <div>
            <label for="responsavelTecnico" class="form-label text-white"
              >Responsável Técnico</label
            >
            <input
              type="text"
              id="responsavelTecnico"
              class="form-control"
              placeholder="Nome do responsável técnico"
              formControlName="responsavelTecnico"
            />
          </div>

          <div>
            <label for="registroResponsavel" class="form-label text-white"
              >Registro do Responsável</label
            >
            <input
              type="text"
              id="registroResponsavel"
              class="form-control"
              placeholder="Registro do responsável técnico"
              formControlName="registroResponsavel"
            />
          </div>

          <div>
            <label for="especialidadesAtendidas" class="form-label text-white"
              >Especialidades Atendidas (separadas por vírgula)</label
            >
            <input
              type="text"
              id="especialidadesAtendidas"
              class="form-control"
              placeholder="Ex: Cardiologia, Dermatologia"
              formControlName="especialidadesAtendidas"
            />
          </div>

          <div>
            <label for="site" class="form-label text-white">Site</label>
            <input
              type="url"
              id="site"
              class="form-control"
              placeholder="URL do site da clínica"
              formControlName="site"
            />
          </div>

          <div>
            <label for="horarioFuncionamento" class="form-label text-white"
              >Horário de Funcionamento</label
            >
            <input
              type="text"
              id="horarioFuncionamento"
              class="form-control"
              placeholder="Ex: Seg a Sex, 8h às 18h"
              formControlName="horarioFuncionamento"
            />
          </div>

          <div>
            <label for="descricaoClinica" class="form-label text-white"
              >Descrição</label
            >
            <textarea
              id="descricaoClinica"
              class="form-control"
              placeholder="Descrição da clínica"
              formControlName="descricaoClinica"
              rows="3"
            ></textarea>
          </div>
        </div>

        <!-- Planos pagos para Clínica e Profissional Autônomo -->
        <div
          *ngIf="
            tipoUsuarioSelecionado === tipoUsuarioEnum.CLINICA ||
            tipoUsuarioSelecionado === tipoUsuarioEnum.PROFISSIONAL_AUTONOMO
          "
          class="mb-4 mt-4"
        >
          <h6>Selecione um plano para anúncios</h6>

          <div class="d-flex flex-wrap gap-3 justify-content-center">
            <label
              *ngFor="let plano of planos"
              class="card plano-card p-3 flex-grow-1"
              [ngClass]="{
                'border-success shadow-lg':
                  registerForm.get('planoSelecionado')?.value === plano.id,
                'border-secondary':
                  registerForm.get('planoSelecionado')?.value !== plano.id
              }"
              style="min-width: 220px; cursor: pointer; user-select: none"
              [attr.for]="plano.id"
            >
              <input
                type="radio"
                class="d-none"
                [id]="plano.id"
                formControlName="planoSelecionado"
                [value]="plano.id"
              />
              <div class="card-body p-0">
                <h5 class="card-title text-success mb-2">{{ plano.nome }}</h5>
                <p class="card-text mb-2" style="min-height: 3rem">
                  {{ plano.descricao }}
                </p>
                <p class="fw-bold fs-5 mb-0">
                  R$ {{ plano.preco | number : "1.2-2" }}
                </p>
              </div>
            </label>
          </div>

          <div
            *ngIf="
              registerForm.get('planoSelecionado')?.invalid &&
              registerForm.get('planoSelecionado')?.touched
            "
            class="invalid-feedback d-block mt-2"
          >
            Por favor, selecione um plano.
          </div>
        </div>

        <div class="mt-3">
          <button
            type="submit"
            class="btn btn-success w-100 mb-2"
            [disabled]="registerForm.invalid"
            style="background-color: #28b463"
          >
            Criar Conta
          </button>
        </div>
      </form>

      <div class="text-center mt-3 border-top pt-3">
        <span class="text-white d-block mb-1">Já tem uma conta?</span>
        <a
          routerLink="/"
          class="btn btn-outline-light btn-sm px-4"
          style="border-color: #28b463; color: #28b463"
        >
          Fazer login
        </a>
      </div>
    </div>
  </div>

  <!-- Footer -->
  <app-footer></app-footer>
</div>
